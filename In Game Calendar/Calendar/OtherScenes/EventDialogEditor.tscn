[gd_scene load_steps=6 format=3 uid="uid://chjer1gbx4i16"]

[ext_resource type="Theme" uid="uid://bxgmder5bm31h" path="res://addons/In Game Calendar/Calendar/Resources/Theme.tres" id="1_ovomg"]
[ext_resource type="LabelSettings" uid="uid://f8u7dhqdd61g" path="res://addons/In Game Calendar/Calendar/Resources/LabelSettingBig.tres" id="3_f7neg"]
[ext_resource type="FontFile" uid="uid://d0684swyadc76" path="res://addons/In Game Calendar/Calendar/Resources/BoldPixels.ttf" id="4_46wqq"]

[sub_resource type="GDScript" id="GDScript_m45d0"]
script/source = "extends Window

signal event_created(title: String, day_index: int, hour: int, minute: int, category: String)

var day_index: int = 0

@onready var title_edit: LineEdit = %TitleEdit
@onready var hour_spin: SpinBox = %HourSpin
@onready var minute_spin: SpinBox = %MinuteSpin
@onready var category_option: OptionButton = %CategoryOption
@onready var note_edit: TextEdit = %NoteEdit

func _ready():
	# Configurer les catÃ©gories
	category_option.clear()
	category_option.add_item(\"General\", 0)
	category_option.add_item(\"Story\", 1)
	category_option.add_item(\"Quest\", 2)
	category_option.add_item(\"Deadline\", 3)
	category_option.add_item(\"Reminder\", 4)
	category_option.add_item(\"Meeting\", 5)
	
	%CreateButton.pressed.connect(_on_create_pressed)
	%CancelButton.pressed.connect(_on_cancel_pressed)

func setup(p_day_index: int):
	day_index = p_day_index
	title = \"Add Event - Day %d\" % (day_index + 1)

func _on_create_pressed():
	if title_edit.text.strip_edges().is_empty():
		push_warning(\"Event title cannot be empty\")
		return
	
	var categories = [\"general\", \"story\", \"quest\", \"deadline\", \"reminder\", \"meeting\"]
	var category = categories[category_option.selected]
	
	event_created.emit(
		title_edit.text.strip_edges(),
		day_index,
		int(hour_spin.value),
		int(minute_spin.value),
		category
	)
	
	queue_free()

func _on_cancel_pressed():
	queue_free()

func _on_close_requested() -> void:
	_on_cancel_pressed()
"

[sub_resource type="LabelSettings" id="LabelSettings_tn80l"]
font = ExtResource("4_46wqq")
font_size = 32

[node name="Window" type="Window"]
transparent_bg = true
oversampling_override = 1.0
size = Vector2i(600, 300)
unresizable = true
transparent = true
theme = ExtResource("1_ovomg")
script = SubResource("GDScript_m45d0")

[node name="MarginContainer" type="MarginContainer" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 8.0
offset_top = 8.0
offset_right = -8.0
offset_bottom = -8.0
grow_horizontal = 2
grow_vertical = 2

[node name="VBoxContainer" type="VBoxContainer" parent="MarginContainer"]
layout_mode = 2

[node name="HBoxContainer" type="HBoxContainer" parent="MarginContainer/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3

[node name="Names" type="VBoxContainer" parent="MarginContainer/VBoxContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_stretch_ratio = 0.6

[node name="Label" type="Label" parent="MarginContainer/VBoxContainer/HBoxContainer/Names"]
custom_minimum_size = Vector2(0, 40)
layout_mode = 2
text = "Event Name:  "
label_settings = ExtResource("3_f7neg")
vertical_alignment = 1

[node name="Label2" type="Label" parent="MarginContainer/VBoxContainer/HBoxContainer/Names"]
custom_minimum_size = Vector2(0, 40)
layout_mode = 2
text = "Time:  "
label_settings = ExtResource("3_f7neg")
vertical_alignment = 1

[node name="Label3" type="Label" parent="MarginContainer/VBoxContainer/HBoxContainer/Names"]
custom_minimum_size = Vector2(0, 40)
layout_mode = 2
text = "Category:  "
label_settings = ExtResource("3_f7neg")
vertical_alignment = 1

[node name="Label4" type="Label" parent="MarginContainer/VBoxContainer/HBoxContainer/Names"]
custom_minimum_size = Vector2(0, 40)
layout_mode = 2
text = "Note:  "
label_settings = ExtResource("3_f7neg")
vertical_alignment = 1

[node name="Value" type="VBoxContainer" parent="MarginContainer/VBoxContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3

[node name="TitleEdit" type="LineEdit" parent="MarginContainer/VBoxContainer/HBoxContainer/Value"]
unique_name_in_owner = true
custom_minimum_size = Vector2(0, 40)
layout_mode = 2
size_flags_horizontal = 3
theme = ExtResource("1_ovomg")
placeholder_text = "Event Name"
alignment = 1
caret_blink = true

[node name="HBoxContainer2" type="HBoxContainer" parent="MarginContainer/VBoxContainer/HBoxContainer/Value"]
custom_minimum_size = Vector2(0, 40)
layout_mode = 2

[node name="HourSpin" type="SpinBox" parent="MarginContainer/VBoxContainer/HBoxContainer/Value/HBoxContainer2"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
theme = ExtResource("1_ovomg")
max_value = 23.0
value = 12.0
alignment = 1
suffix = "h"
custom_arrow_step = 1.0

[node name="Label2" type="Label" parent="MarginContainer/VBoxContainer/HBoxContainer/Value/HBoxContainer2"]
custom_minimum_size = Vector2(0, 40)
layout_mode = 2
text = " : "
label_settings = SubResource("LabelSettings_tn80l")
vertical_alignment = 1

[node name="MinuteSpin" type="SpinBox" parent="MarginContainer/VBoxContainer/HBoxContainer/Value/HBoxContainer2"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
theme = ExtResource("1_ovomg")
max_value = 59.0
step = 5.0
alignment = 1
suffix = "min"

[node name="CategoryOption" type="OptionButton" parent="MarginContainer/VBoxContainer/HBoxContainer/Value"]
unique_name_in_owner = true
custom_minimum_size = Vector2(0, 40)
layout_mode = 2
theme = ExtResource("1_ovomg")
allow_reselect = true

[node name="NoteEdit" type="TextEdit" parent="MarginContainer/VBoxContainer/HBoxContainer/Value"]
unique_name_in_owner = true
custom_minimum_size = Vector2(0, 115)
layout_mode = 2
theme = ExtResource("1_ovomg")
placeholder_text = " Note"
backspace_deletes_composite_character_enabled = true
wrap_mode = 1
caret_blink = true

[node name="HBoxContainer2" type="HBoxContainer" parent="MarginContainer/VBoxContainer"]
layout_mode = 2

[node name="SaveButton" type="Button" parent="MarginContainer/VBoxContainer/HBoxContainer2"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
theme = ExtResource("1_ovomg")
text = "Save"

[node name="DeleteButton" type="Button" parent="MarginContainer/VBoxContainer/HBoxContainer2"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
theme = ExtResource("1_ovomg")
text = "Delete"

[node name="CancelButton" type="Button" parent="MarginContainer/VBoxContainer/HBoxContainer2"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
theme = ExtResource("1_ovomg")
text = "Cancel"

[connection signal="close_requested" from="." to="." method="_on_close_requested"]
